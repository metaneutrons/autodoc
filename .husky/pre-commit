#!/bin/sh

echo "ğŸ” Pre-commit checks..."

# Check if only non-code files are changed
changed_files=$(git diff --cached --name-only)
code_files=$(echo "$changed_files" | grep -v -E '\.(md|yml|yaml|json|txt)$|^\.github/|^docs/|^README|^LICENSE|^CHANGELOG')

if [ -z "$code_files" ]; then
    echo "ğŸ“ Only documentation/config files changed, skipping Rust compilation"
    echo "âœ… Pre-commit checks passed"
    exit 0
fi

# Check if Rust compiles without errors
echo "ğŸ“¦ Checking Rust compilation..."
if ! cargo check --quiet; then
    echo "âŒ Rust compilation failed. Fix errors before committing."
    exit 1
fi

echo "âœ… Rust compilation successful"
echo "âœ… Pre-commit checks passed"
